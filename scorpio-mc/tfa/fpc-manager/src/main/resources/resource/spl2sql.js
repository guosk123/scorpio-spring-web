/**
 * spl2sql - Convert Splunk SPL to ClickHouse SQL with pegjs
 * @version v0.0.5
 * @author wangfucheng <wangfucheng@machloop.com>
 * @buildAt 2022-09-13T08:49:33.514Z
 */
 function _slicedToArray(t,r){return _arrayWithHoles(t)||_iterableToArrayLimit(t,r)||_unsupportedIterableToArray(t,r)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,r){if(t){if("string"==typeof t)return _arrayLikeToArray(t,r);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(t,r):void 0}}function _arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var n=0,e=new Array(r);n<r;n++)e[n]=t[n];return e}function _iterableToArrayLimit(t,r){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],e=!0,o=!1,a=void 0;try{for(var c,i=t[Symbol.iterator]();!(e=(c=i.next()).done)&&(n.push(c.value),!r||n.length!==r);e=!0);}catch(t){o=!0,a=t}finally{try{e||null==i.return||i.return()}finally{if(o)throw a}}return n}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}(function(t,r){"function"==typeof define&&define.amd?define([],r):"object"===("undefined"==typeof module?"undefined":_typeof(module))&&module.exports?module.exports=r():t.splToSqlConverter=r()})(this,function(){"use strict";function To(t,r,n,e){this.message=t,this.expected=r,this.found=n,this.location=e,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,To)}function t(){this.constructor=r}var r,n;return r=To,n=Error,t.prototype=n.prototype,r.prototype=new t,To.buildMessage=function(t,r){var n,a={literal:function(t){return'"'+o(t.text)+'"'},class:function(t){for(var r="",n=0;n<t.parts.length;n++)r+=t.parts[n]instanceof Array?c(t.parts[n][0])+"-"+c(t.parts[n][1]):c(t.parts[n]);return"["+(t.inverted?"^":"")+r+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(t){return t.description}};function e(t){return t.charCodeAt(0).toString(16).toUpperCase()}function o(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(t){return"\\x0"+e(t)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(t){return"\\x"+e(t)})}function c(t){return t.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(t){return"\\x0"+e(t)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(t){return"\\x"+e(t)})}return"Expected "+function(t){for(var r,n,e=new Array(t.length),o=0;o<t.length;o++)e[o]=(n=t[o],a[n.type](n));if(e.sort(),0<e.length){for(r=o=1;o<e.length;o++)e[o-1]!==e[o]&&(e[r]=e[o],r++);e.length=r}switch(e.length){case 1:return e[0];case 2:return e[0]+" or "+e[1];default:return e.slice(0,-1).join(", ")+", or "+e[e.length-1]}}(t)+" but "+((n=r)?'"'+o(n)+'"':"end of input")+" found."},{SyntaxError:To,parse:function(h,t){var v={},r={start:Ce},n=Ce,u=Ae("SplExpression"),f=function(t,r){var n,e,o,a,c=_slicedToArray(t,2),i=(c[0],c[1]),u="",f={WHERE:i};r.forEach(function(t){t&&t[3]&&(f=Object.assign(f,t[3]))}),i&&(u+=i),f.GENTIMES&&(n=(e=f.GENTIMES).time_field,a=e.time_from,o=e.time_to,t=vo(a),c=vo(o),r=Po?">=":">",e=go?"<=":"<",o=vo(a-oo),a="",mo?(a+="(",a+=" start_time >= toDateTime64(:param_aging_start_time, ".concat(Co,", 'UTC') "),a+=" and start_time < toDateTime64(:param_end_time, ".concat(Co,", 'UTC') "),a+=" and end_time >= toDateTime64(:param_start_time, ".concat(Co,", 'UTC') "),a+=")",fo.param_aging_start_time=o):a+="(`"+n+"`"+"".concat(r," toDateTime64(:param_start_time, ").concat(Co,", 'UTC') AND ")+"`"+n+"`"+" ".concat(e," toDateTime64(:param_end_time, ").concat(Co,", 'UTC'))"),f.WHERE=u+=i?" AND ".concat(a):a,fo.param_start_time=t,fo.param_end_time=c),f.ORDER_BY&&(u+=" "+f.ORDER_BY),f.LIMIT&&(u+=" "+f.LIMIT);u={source:le(),target:u,params:fo,dev:{expression:f,fields:io,fieldCollection:Object.keys(uo).map(function(t){return uo[t]})}};return yo?{result:u}:{result:JSON.stringify(u)}},s=Ae("SourceAndSearchExpression"),l=function(t,r){return r&&r[1]&&0!==r.length?["",r[1]]:["",""]},d=Ae("SearchExpression"),A=function(t){return t?"("+t+")":""},c=Ae("RegionOr"),i=function(t,r){return t+" OR "+r},I=Ae("RegionAnd"),p=function(t,r){return t+" AND "+r},a=Ae("FactorBlock"),y=function(t){return"("+t+")"},m=Ae("BasicCondition"),C=function(t,r,n){var e=t.fieldName,o=t.fieldType,a="<="===r?"<=":"<"===r?"<":">="===r?">=":">"===r?">":"!="===r?"!=":"="===r?"=":"",c=Ao(e,o),i=c.paramKey,u=c.paramName;if(o&&-1<o.indexOf("Array")&&"="!==a)throw Error("数组类型的字段只支持 = 搜索");if("Array"===o){var f=n.split(",").filter(function(t){return t});if(2<=f.length){var s=[];return f.forEach(function(t,r){r=i+"_"+r;Io(r,t),s.push(r)})," hasAll(".concat(e,", [").concat(s.join(",")," ])=1")}}var l="IPv4"===o&&lo(n,"IPv4"),d="IPv6"===o&&lo(n,"IPv6");if("IP"===o){var h=ao.test(n)||co.test(n);if(lo(n,"IPv4")||lo(n,"IPv6")){if("="!==a&&"!="!==a)throw Error("CIDR格式的IP地址只支持等于或不等于搜索");var v=de(),A=v.start,t=v.end,r=no+A.line+"_"+A.offset+"_"+t.line+"_"+t.offset,c=_slicedToArray(n.split("/"),2),f=c[0],v=c[1],A="",t="".concat(r,"_ip"),c="".concat(r,"_mask"),r="!="===a?"NOT":"";return ao.test(f)&&(f="::ffff:".concat(f),v=parseInt(v,10)+96),po(e,"CIDR_IPV6",a,n),A="".concat(e," ").concat(r," between IPv6CIDRToRange(toIPv6(").concat(t,"), ").concat(c,").1 and IPv6CIDRToRange(toIPv6(").concat(t,"), ").concat(c,").2"),r&&(A="((".concat(A,") or isNull(").concat(e,"))")),Io(t,f),Io(c,+v),A}if(h){po(e,o,a,n),Io(i,n);var I="`".concat(e,"` ").concat(a," toIPv6(").concat(u,")");return"!="===a&&(I="((".concat(I,") or isNull(").concat(e,"))")),I}throw Error("请输入一个ip或者ip段")}if("Array<IPv4>"===o&&lo(n,"IPv4")){if("="!==a)throw Error("Array<IPv4>仅支持登录搜索");var p=de(),y=p.start,h=p.end,m=no+y.line+"_"+y.offset+"_"+h.line+"_"+h.offset,I="".concat(m,"_ip"),p="".concat(m,"_mask"),y=_slicedToArray(n.split("/"),2),h=y[0],m=y[1],y="notEmpty(arrayFilter(x -> (x BETWEEN IPv4CIDRToRange(toIPv4(".concat(I,"), ").concat(p,").1 AND IPv4CIDRToRange(toIPv4(").concat(I,"), ").concat(p,").2), ").concat(e,")) = 1");return po(e,"Array<IPv4>",a,n),Io(I,h),Io(p,+m),y}if("Array<IPv6>"===o&&lo(n,"IPv6")){if("="!==a)throw Error("Array<IPv6>仅支持登录搜索");var p=de(),C=p.start,m=p.end,P=no+C.line+"_"+C.offset+"_"+m.line+"_"+m.offset,y="".concat(P,"_ip"),p="".concat(P,"_mask"),C=_slicedToArray(n.split("/"),2),m=C[0],P=C[1],C="notEmpty(arrayFilter(x -> (x BETWEEN IPv6CIDRToRange(toIPv6(".concat(y,"), ").concat(p,").1 AND IPv6CIDRToRange(toIPv6(").concat(y,"), ").concat(p,").2), ").concat(e,")) = 1");return po(e,"Array<IPv4>",a,n),Io(y,m),Io(p,+P),C}if(l||d){if("="!==a&&"!="!==a)throw Error("CIDR格式的IP地址只支持等于或不等于搜索");var g=de(),T=g.start,P=g.end,C=no+T.line+"_"+T.offset+"_"+P.line+"_"+P.offset,l=_slicedToArray(n.split("/"),2),d=l[0],g=l[1],T="",P="".concat(C,"_ip"),l="".concat(C,"_mask"),C="!="===a?"NOT":"";return"IPv4"===o&&(po(e,"CIDR_IPv4",a,n),T="".concat(e," ").concat(C," between IPv4CIDRToRange(toIPv4(").concat(P,"), ").concat(l,").1 and IPv4CIDRToRange(toIPv4(").concat(P,"), ").concat(l,").2")),"IPv6"===o&&(po(e,"CIDR_IPv6",a,n),T="".concat(e," ").concat(C," between IPv6CIDRToRange(toIPv6(").concat(P,"), ").concat(l,").1 and IPv6CIDRToRange(toIPv6(").concat(P,"), ").concat(l,").2")),C&&(T="((".concat(T,") or isNull(").concat(e,"))")),Io(P,d),Io(l,+g),T}if("Array<CIDR_IPv4>"===o||"Array<CIDR_IPv6>"===o){if("="!==a)throw Error("Array<CIDR_IPv4> 或 Array<CIDR_IPv6> 格式的IP地址只支持等于搜索");if(!lo(n,"IPv4")&&!lo(n,"IPv6"))throw Error("".concat(n,"不是个正确的CIDR_IP地址"));g=de(),T=g.start,g=g.end,T=no+T.line+"_"+T.offset+"_"+g.line+"_"+g.offset,g="".concat(T,"_ip"),T="";return"Array<CIDR_IPv4>"===o&&(T="notEmpty(arrayFilter(y -> (toIPv4(".concat(g,") BETWEEN y.1 AND y.2), arrayMap(x -> (IPv4CIDRToRange(toIPv4(splitByChar('/', x)[1]), toUInt8(splitByChar('/', x)[2]))), ").concat(e,")))")),"Array<CIDR_IPv6>"===o&&(T="notEmpty(arrayFilter(y -> (toIPv6(".concat(g,") BETWEEN y.1 AND y.2), arrayMap(x -> (IPv6CIDRToRange(toIPv6(splitByChar('/', x)[1]), toUInt8(splitByChar('/', x)[2]))), ").concat(e,")))")),po(e,o,a,n),Io(g,n),T}if(a){if("IPv4"===o&&!ao.test(n)&&!lo(n,"IPv4"))throw Error("".concat(n,"不是个正确的IPv4"));if("Array<IPv4>"===o&&!ao.test(n))throw Error("".concat(n,"不是个正确的IPv4"));if("IPv6"===o&&!co.test(n)&&!lo(n,"IPv6")&&!lo(n,"IPv4"))throw Error("".concat(n,"不是个正确的IPv6"));if("Array<IPv6>"===o&&!co.test(n))throw Error("".concat(n,"不是个正确的IPv6"));if(po(e,o,a,n),Io(i,n),-1<o.indexOf("Array"))return" "+u;if("Map"!==o)return"!="===a?"((`"+e+"`"+a+u+") or isNull("+e+"))":"`"+e+"`"+a+u;o=_slicedToArray(e.split("."),2),e=o[0],o=o[1];return"".concat(e,"['").concat(o,"'] ").concat(a," ").concat(u)}return""},P=Ae("InCondition"),g=function(t,r){var n=t.fieldName,e=t.fieldType,t=Ao(n,e),o=t.paramKey,t=t.paramName;if("IPv4"===e||"IPv6"===e){var a=[];return r.forEach(function(t,r){r=o+"_"+r;if(Io(r,t),"IPv4"===e){if(!ao.test(t))throw Error("".concat(t,"不是个正确的IPv4"));a.push("toIPv4(".concat(r,")"))}else{if(!co.test(t))throw Error("".concat(t,"不是个正确的IPv6"));a.push("toIPv6(".concat(r,")"))}}),"`"+n+"` IN ("+a.join(",")+")"}if("Array"!==e&&"Array<IPv4>"!==e&&"Array<IPv6>"!==e)return Io(o,r),"`"+n+"` IN ("+t+")";var c=[];return r.forEach(function(t,r){r=o+"_"+r;if(Io(r,t),"Array<IPv4>"===e){if(!ao.test(t))throw Error("".concat(t,"不是个正确的IPv4"));c.push("toIPv4(".concat(r,")"))}else if("Array<IPv6>"===e){if(!co.test(t))throw Error("".concat(t,"不是个正确的IPv6"));c.push("toIPv6(".concat(r,")"))}else c.push(r)})," hasAny(`"+n+"`, ["+c.join(",")+"])=1"},T=Ae("NotInCondition"),_=function(t,r){var n=t.fieldName,e=t.fieldType,t=Ao(n,e),o=t.paramKey,t=t.paramName;if("IPv4"===e||"IPv6"===e){var a=[];return r.forEach(function(t,r){r=o+"_"+r;if(Io(r,t),"IPv4"===e){if(!ao.test(t))throw Error("".concat(t,"不是个正确的IPv4"));a.push("toIPv4(".concat(r,")"))}else{if(!co.test(t))throw Error("".concat(t,"不是个正确的IPv6"));a.push("toIPv6(".concat(r,")"))}}),"`"+n+"` NOT IN ("+a.join(",")+")"}if("Array"!==e&&"Array<IPv4>"!==e&&"Array<IPv6>"!==e)return Io(o,r),"`"+n+"` NOT IN ("+t+")";var c=[];return r.forEach(function(t,r){r=o+"_"+r;if(Io(r,t),"Array<IPv4>"===e){if(!ao.test(t))throw Error("".concat(t,"不是个正确的IPv4"));c.push("toIPv4(".concat(r,")"))}else if("Array<IPv6>"===e){if(!co.test(t))throw Error("".concat(t,"不是个正确的IPv6"));c.push("toIPv6(".concat(r,")"))}else c.push(r)})," hasAny(`"+n+"`, ["+c.join(",")+"])=0"},o=Ae("MultipleValue"),E=function(t,r){r=[t].concat(r);return r.filter(function(t,r,n){return n.indexOf(t)===r})},e=Ae("MoreMultipleValues"),b=",",w=he(",",!1),D=function(t){return t},R=Ae("MatchCondition"),N=function(t,r){var n=t.fieldName,e=t.fieldType;if(e&&-1<e.indexOf("IP"))throw Error("IP类型的字段不支持正则表达式");var o=Ao(n,e),t=o.paramKey,o=o.paramName;if(Io(t,"".concat(r)),"Array"===e)return" notEmpty(arrayFilter(x -> match(x, ".concat(t,"), ").concat(n,"))");if(po(n,e,"reg",r),"Map"!==e)return"match(".concat(n,", ").concat(o,") = 1");e=_slicedToArray(n.split("."),2),n=e[0],e=e[1];return"match(".concat(n,"['").concat(e,"'], ").concat(o,") = 1")},S=Ae("LikeCondition"),x=function(t,r){var n=t.fieldName,e=t.fieldType;if(e&&-1<e.indexOf("IP"))throw Error("IP类型的字段不支持LIKE");var o=Ao(n,e),t=o.paramKey,o=o.paramName;if(Io(t,"%".concat(r,"%")),"Array"===e)return" notEmpty(arrayFilter(x -> x ILIKE "+t+",`"+n+"`))";if(po(n,e,"like",r),"Map"!==e)return"`"+n+"` ILIKE "+o;e=_slicedToArray(n.split("."),2),n=e[0],e=e[1];return" ".concat(n,"['").concat(e,"'] ILIKE ").concat(o)},F=Ae("NotLikeCondition"),O=function(t,r){var n=t.fieldName,e=t.fieldType;if(-1<e.indexOf("IP"))throw Error("IP类型的字段不支持 NOT LIKE");var o=Ao(n,e),t=o.paramKey,o=o.paramName;if(Io(t,"%".concat(r,"%")),"Array"===e)return" notEmpty(arrayFilter(x -> x NOT ILIKE "+t+",`"+n+"`))";if(po(n,e,"not_like",r),"Map"!==e)return"`"+n+"` NOT ILIKE "+o;e=_slicedToArray(n.split("."),2),n=e[0],e=e[1];return" ".concat(n,"['").concat(e,"'] NOT ILIKE ").concat(o)},M=Ae("ExistsCondition"),L=function(t){var r=t.fieldName;t.fieldType;return"not empty(`"+r+"`)"},j=Ae("NotExistsCondition"),H=function(t){var r=t.fieldName;t.fieldType;return"empty(`"+r+"`)"},U=Ae("TailCommand"),Y=Ae("FieldsCommand"),K=function(t,r){var r=[t].concat(r),n=[],e=[];return r.forEach(function(t){var r=t.op,t=t.field;"+"===r&&n.push(t),"-"===r&&e.push(t)}),{COLUMNS:n.map(function(t){return"`"+t+"`"}).join(",")}},k=Ae("Column"),Z=function(t,r){return{op:t||"+",field:r}},B=Ae("MoreColumns"),z=function(t){return t},W=Ae("HeadCommand"),V=function(t){if(t<=0)throw Error("返回结果的数量至少为1");return{LIMIT:"LIMIT 0,"+t}},G=Ae("SortCommand"),$=function(t,r,n){return{ORDER_BY:"ORDER BY "+[[t,r]].concat(n).map(function(t){var r=_slicedToArray(t,2),t=r[0];return r[1]+" "+(t&&t!==ro?"DESC":"ASC")})}},X=Ae("MoreSort"),q=function(t,r){return[t,r]},J=Ae("GentimesCommand"),Q="start",tt=he("start",!0),rt="end",nt=he("end",!0),et=function(t,r,n){var e=so;return 0<n.length&&(e=n[0][5]),{GENTIMES:{time_field:t,time_from:r,time_to:e}}},ot=Ae("TimeValue"),at='"',ct=he('"',!1),it=function(t){return t},ut="'",ft=he("'",!1),st=Ae("RelativeTime"),lt="now-",dt=he("now-",!1),ht=function(t,r){var n=new Date(so);return"y"===r&&(n=n.setFullYear(n.getFullYear()-t)),"M"===r&&(n=n.setMonth(n.getMonth()-t)),"w"===r&&(n=n.setDate(n.getDate()-7*t)),"d"===r&&(n=n.setDate(n.getDate()-t)),"h"!==r&&"H"!==r||(n=n.setHours(n.getHours()-t)),"m"===r&&(n=n.setMinutes(n.getMinutes()-t)),"s"===r&&(n=n.setSeconds(n.getSeconds()-t)),new Date(n).getTime()},vt=Ae("now"),At="now",It=he("now",!1),pt=function(){return so},yt=Ae("TimeUnit"),mt="y",Ct=he("y",!1),Pt="M",gt=he("M",!1),Tt="w",_t=he("w",!1),Et="d",bt=he("d",!1),wt="h",Dt=he("h",!1),Rt="H",Nt=he("H",!1),St="m",xt=he("m",!1),Ft="s",Ot=he("s",!1),Mt=le,Lt=Ae("Timestamp"),jt=function(t){if(13!==String(t).length)throw Error("请输入毫秒级的时间戳");return t},Ht=Ae("UTCTime"),Ut="-",Yt=he("-",!1),Kt="T",kt=he("T",!1),Zt=":",Bt=he(":",!1),zt=function(t,r,n,e,o,a,c){if(4!==String(t).length||2!==String(r).length||2!==String(n).length||2!==String(e).length||2!==String(o).length||2!==String(a).length)throw Error("时间格式错误。时间格式：YYYY-MM-DDTHH:mm:ssZ");n="";if(c){e=_slicedToArray(c,3),o=e[0],a=e[1],c=e[2],e=parseInt(a);if(12<e||e<-12)throw Error("错误的时区范围");if(c&&c.length<2||c&&2===c.length&&("0"!==c[0]||"0"!==c[1])||e<10&&("0"!==a.charAt(0)||"0"===a.charAt(0)&&2!==a.length))throw Error("时区格式错误. 未能解析日期字段 [".concat(le(),"], 请输入 [").concat(o,"0").concat(e,"] 或 [").concat(o,"0").concat(e,":00]"));n=0===c.length?"".concat(le(),":00"):le()}else n="".concat(le(),"+08:00");return new Date(n).getTime()},Wt=Ae("YYYYMMDDHHmmss"),Vt=function(t,r,n,e,o,a){if(4!==String(t).length||2!==String(r).length||2!==String(n).length||2!==String(e).length||2!==String(o).length||2!==String(a).length)throw Error("时间格式错误。时间格式：YYYY-MM-DD HH:mm:ss");return new Date(le().replace(/ /,"T")+(o=(new Date).getTimezoneOffset(),a=0<o?"-":"+",o=Math.abs(o)/60,"".concat(a).concat(ho(o),":00"))).getTime()},Gt=Ae("TimeInteger"),$t=/^[0-9]/,Xt=ve([["0","9"]],!1,!1),qt=function(t){return t.join("")},Jt=Ae("TimeZone"),Qt="+",tr=he("+",!1),rr="00",nr=he("00",!1),er=":00",or=he(":00",!1),ar=function(t,r,n){r=r.join("");return n=n||r.slice(2,4),[t,r.slice(0,2),n]},cr=/^[ \t\r\n]/,ir=ve([" ","\t","\r","\n"],!1,!1),ur=/^[ ]/,fr=ve([" "],!1,!1),sr=Ae("DataSource"),lr=/^[a-zA-Z0-9._\-*]/,dr=ve([["a","z"],["A","Z"],["0","9"],".","_","-","*"],!1,!1),hr=Ae("Field"),vr=/^[A-Za-z0-9_.]/,Ar=ve([["A","Z"],["a","z"],["0","9"],"_","."],!1,!1),Ir=function(t){t=t.join("");return-1===io.indexOf(t)&&-1===["fields","FIELDS","sort","SORT","gentimes","GENTIMES","head","HEAD"].indexOf(t)&&io.push(t),t},pr=Ae("FieldWithType"),yr=function(t,r){var n=t.join(""),t=n+(r?"<"+r+">":"");return-1===io.indexOf(t)&&-1===["fields","FIELDS","sort","SORT","gentimes","GENTIMES","head","HEAD"].indexOf(n)&&io.push(t),{fieldName:n,fieldType:r||""}},mr=Ae("FieldType"),Cr="<",Pr=he("<",!1),gr=/^[A-Za-z0-9]/,Tr=ve([["A","Z"],["a","z"],["0","9"]],!1,!1),_r=">",Er=he(">",!1),br=function(t,r){t=t.join("");if(-1===["IP","IPv4","IPv6","Array","Map"].indexOf(t))throw Error("字段类型只能是".concat(eo.join("、")));return t+(r?"<".concat(r,">"):"")},wr=Ae("FieldSecondType"),Dr=/^[A-Za-z0-9_]/,Rr=ve([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),Nr=function(t){t=t.join("");if(-1===["IPv4","IPv6","CIDR_IPv4","CIDR_IPv6"].indexOf(t))throw Error("字段类型只能是".concat(eo.join("、")));return t},Sr=Ae("DefaultValue"),xr=/^[\u4E00-\u9FA5_a-zA-Z0-9a-zA-Z0-9~\xB7!@#$%\^&*_\-+={}[\]\\<>,.?\/:;\uFF01\uFFE5\uFF1B\uFF1A\uFF0C\u3002]/,Fr=ve([["一","龥"],"_",["a","z"],["A","Z"],["0","9"],["a","z"],["A","Z"],["0","9"],"~","·","!","@","#","$","%","^","&","*","_","-","+","=","{","}","[","]","\\","<",">",",",".","?","/",":",";","！","￥","；","：","，","。"],!1,!1),Or=function(t){return!isNaN(Number(t))?Number(t):t},Mr=(Ae("QuotedValue"),ve([["一","龥"],"_",["a","z"],["A","Z"],["0","9"],["a","z"],["A","Z"],["0","9"],"~","·","!","@","#","$","%","^","&","*","(",")","_","-","+","=","{","}","[","]","\\","<",">",",",".","?","/",":",";","！","￥","；","：","，","。"," "],!1,!1),Ae("Value")),Lr=function(t){return t.join("")},jr="\\",Hr=he("\\",!1),Ur={type:"any"},Yr=function(t){return t},Kr=function(t){return t},kr="b",Zr=he("b",!1),Br=function(){return"\b"},zr="f",Wr=he("f",!1),Vr=function(){return"\f"},Gr="n",$r=he("n",!1),Xr=function(){return"\n"},qr="r",Jr=he("r",!1),Qr=function(){return"\r"},tn="t",rn=he("t",!1),nn=function(){return"\t"},en="v",on=he("v",!1),an=function(){return"\v"},cn=Ae("RegValue"),un=function(t){return parseInt(t.join(""))},fn="and",sn=he("AND",!0),ln="&&",dn=he("&&",!1),hn=function(){return Qe},vn="or",An=he("OR",!0),In="||",pn=he("||",!1),yn=function(){return to},mn=(he("true",!1),he("false",!1),"|"),Cn=he("|",!1),Pn="=",gn=he("=",!1),Tn="!=",_n=he("!=",!1),En=">=",bn=he(">=",!1),wn="<=",Dn=he("<=",!1),Rn="(",Nn=he("(",!1),Sn=")",xn=he(")",!1),Fn="source",On=he("SOURCE",!0),Mn="search",Ln=he("SEARCH",!0),jn="fields",Hn=he("FIELDS",!0),Un="head",Yn=he("HEAD",!0),Kn="sort",kn=he("SORT",!0),Zn="gentimes",Bn=he("GENTIMES",!0),zn=(he("SIZE",!0),he("TIMEOUT",!0),he("TRACK_TOTAL_HITS",!0),he("TERMINATE_AFTER",!0),he("TOP",!0),he("LIMIT",!0),"in"),Wn=he("IN",!0),Vn="not in",Gn=he("NOT IN",!0),$n="like",Xn=he("LIKE",!0),qn="not like",Jn=he("NOT LIKE",!0),Qn="exists",te=he("EXISTS",!0),re="not_exists",ne=he("NOT_EXISTS",!0),ee="match",oe=he("match",!0),ae=0,ce=0,ie=[{line:1,column:1}],ue=0,fe=[],se=0;if("startRule"in(t=void 0!==t?t:{})){if(!(t.startRule in r))throw new Error("Can't start parsing from rule \""+t.startRule+'".');n=r[t.startRule]}function le(){return h.substring(ce,ae)}function de(){return pe(ce,ae)}function he(t,r){return{type:"literal",text:t,ignoreCase:r}}function ve(t,r,n){return{type:"class",parts:t,inverted:r,ignoreCase:n}}function Ae(t){return{type:"other",description:t}}function Ie(t){var r,n=ie[t];if(n)return n;for(r=t-1;!ie[r];)r--;for(n={line:(n=ie[r]).line,column:n.column};r<t;)10===h.charCodeAt(r)?(n.line++,n.column=1):n.column++,r++;return ie[t]=n}function pe(t,r){var n=Ie(t),e=Ie(r);return{start:{offset:t,line:n.line,column:n.column},end:{offset:r,line:e.line,column:e.column}}}function ye(t){ae<ue||(ue<ae&&(ue=ae,fe=[]),fe.push(t))}function me(t,r,n){return new To(To.buildMessage(t,r),t,r,n)}function Ce(){return function(){var t,r,n,e,o,a,c,i;if(se++,t=ae,(r=function(){var t,r,n,e,o,a,c;se++,r=t=ae,r=(n=function(){var t;h.substr(ae,6).toLowerCase()===Fn?(t=h.substr(ae,6),ae+=6):(t=v,0===se&&ye(On));return t}())!==v?(e=He(),e!==v?(o=Ge())!==v?(a=He())!==v?(c=function(){var t,r,n;se++,t=ae,r=[],lr.test(h.charAt(ae))?(n=h.charAt(ae),ae++):(n=v,0===se&&ye(dr));if(n!==v)for(;n!==v;)r.push(n),lr.test(h.charAt(ae))?(n=h.charAt(ae),ae++):(n=v,0===se&&ye(dr));else r=v;t=r!==v?h.substring(t,ae):r;se--,t===v&&(r=v,0===se&&ye(sr));return t}())!==v?n=[n,e,o,a,c]:(ae=r,v):(ae=r,v):(ae=r,v):(ae=r,v)):(ae=r,v);r===v&&(r=null);t=r!==v?(n=ae,e=He(),(n=e!==v?(o=function(){var t,r,n,e,o,a;se++,r=t=ae,r=(n=Ve())!==v?(e=He(),e!==v?(o=function(){var t;h.substr(ae,6).toLowerCase()===Mn?(t=h.substr(ae,6),ae+=6):(t=v,0===se&&ye(Ln));return t}())!==v?(a=je())!==v?n=[n,e,o,a]:(ae=r,v):(ae=r,v):(ae=r,v)):(ae=r,v);r===v&&(r=null);t=r!==v?(n=Pe(),n!==v?(ce=t,r=A(n)):(ae=t,v)):(ae=t,v);se--,t===v&&(r=v,0===se&&ye(d));return t}())!==v?e=[e,o]:(ae=n,v):(ae=n,v))===v&&(n=null),n!==v?(ce=t,r=l(r,n)):(ae=t,v)):(ae=t,v);se--,t===v&&(r=v,0===se&&ye(s));return t}())!==v){for(n=[],e=ae,(o=je())===v&&(o=null),e=o!==v?(a=Ve())!==v?((c=je())===v&&(c=null),c!==v?(i=be())!==v?o=[o,a,c,i]:(ae=e,v):(ae=e,v)):(ae=e,v):(ae=e,v);e!==v;)n.push(e),e=ae,(o=je())===v&&(o=null),e=o!==v?(a=Ve())!==v?((c=je())===v&&(c=null),c!==v?(i=be())!==v?o=[o,a,c,i]:(ae=e,v):(ae=e,v)):(ae=e,v):(ae=e,v);t=n!==v?((e=He())===v&&(e=null),e!==v?(ce=t,r=f(r,n)):(ae=t,v)):(ae=t,v)}else ae=t,t=v;se--,t===v&&(r=v,0===se&&ye(u));return t}()}function Pe(){var t,r,n,e,o,a;if(se++,t=ae,(r=ge())!==v){if(n=[],(e=Ue())!==v)for(;e!==v;)n.push(e),e=Ue();else n=v;if(n!==v)if((e=function(){var t,r;h.substr(ae,2).toLowerCase()===vn?(t=h.substr(ae,2),ae+=2):(t=v,0===se&&ye(An));t===v&&(t=ae,h.substr(ae,2)===In?(r=In,ae+=2):(r=v,0===se&&ye(pn)),r!==v&&(ce=t,r=yn()),t=r);return t}())!==v){if(o=[],(a=Ue())!==v)for(;a!==v;)o.push(a),a=Ue();else o=v;t=o!==v&&(a=Pe())!==v?(ce=t,r=i(r,a)):(ae=t,v)}else ae=t,t=v;else ae=t,t=v}else ae=t,t=v;return t===v&&(t=ge()),se--,t===v&&(r=v,0===se&&ye(c)),t}function ge(){var t,r,n,e,o,a;if(se++,t=ae,(r=Te())!==v){if(n=[],(e=Ue())!==v)for(;e!==v;)n.push(e),e=Ue();else n=v;if(n!==v)if((e=function(){var t,r;h.substr(ae,3).toLowerCase()===fn?(t=h.substr(ae,3),ae+=3):(t=v,0===se&&ye(sn));t===v&&(t=ae,h.substr(ae,2)===ln?(r=ln,ae+=2):(r=v,0===se&&ye(dn)),r!==v&&(ce=t,r=hn()),t=r);return t}())!==v){if(o=[],(a=Ue())!==v)for(;a!==v;)o.push(a),a=Ue();else o=v;t=o!==v&&(a=ge())!==v?(ce=t,r=p(r,a)):(ae=t,v)}else ae=t,t=v;else ae=t,t=v}else ae=t,t=v;return t===v&&(t=Te()),se--,t===v&&(r=v,0===se&&ye(I)),t}function Te(){var t,r,n,e,o;if(se++,(t=function(){var t,r,n,e;se++,t=ae,t=(r=Ke())!==v?(e=He(),e!==v?((n=Ge())===v&&(n=function(){var t;h.substr(ae,2)===Tn?(t=Tn,ae+=2):(t=v,0===se&&ye(_n));return t}())===v&&(n=function(){var t;h.substr(ae,2)===En?(t=En,ae+=2):(t=v,0===se&&ye(bn));return t}())===v&&(n=function(){var t;62===h.charCodeAt(ae)?(t=_r,ae++):(t=v,0===se&&ye(Er));return t}())===v&&(n=function(){var t;h.substr(ae,2)===wn?(t=wn,ae+=2):(t=v,0===se&&ye(Dn));return t}())===v&&(n=function(){var t;60===h.charCodeAt(ae)?(t=Cr,ae++):(t=v,0===se&&ye(Pr));return t}()),n!==v?He()!==v?(e=ke())!==v?(ce=t,r=C(r,n,e)):(ae=t,v):(ae=t,v):(ae=t,v)):(ae=t,v)):(ae=t,v);t===v&&(t=function(){var t,r,n;se++,t=ae,t=(r=Ke())!==v?(n=je(),n!==v?function(){var t;h.substr(ae,2).toLowerCase()===zn?(t=h.substr(ae,2),ae+=2):(t=v,0===se&&ye(Wn));return t}()!==v?je()!==v?qe()!==v?He()!==v?(n=_e())!==v?He()!==v?Je()!==v?(ce=t,r=g(r,n)):(ae=t,v):(ae=t,v):(ae=t,v):(ae=t,v):(ae=t,v):(ae=t,v):(ae=t,v):(ae=t,v)):(ae=t,v);se--,t===v&&(r=v,0===se&&ye(P));return t}())===v&&(t=function(){var t,r,n;se++,t=ae,t=(r=Ke())!==v?(n=je(),n!==v?function(){var t;h.substr(ae,6).toLowerCase()===Vn?(t=h.substr(ae,6),ae+=6):(t=v,0===se&&ye(Gn));return t}()!==v?je()!==v?qe()!==v?He()!==v?(n=_e())!==v?He()!==v?Je()!==v?(ce=t,r=_(r,n)):(ae=t,v):(ae=t,v):(ae=t,v):(ae=t,v):(ae=t,v):(ae=t,v):(ae=t,v):(ae=t,v)):(ae=t,v);se--,t===v&&(r=v,0===se&&ye(T));return t}())===v&&(t=function(){var t,r,n;se++,t=ae,t=(r=Ke())!==v?(n=je(),n!==v?function(){var t;h.substr(ae,4).toLowerCase()===$n?(t=h.substr(ae,4),ae+=4):(t=v,0===se&&ye(Xn));return t}()!==v?je()!==v?(n=ke())!==v?(ce=t,r=x(r,n)):(ae=t,v):(ae=t,v):(ae=t,v):(ae=t,v)):(ae=t,v);se--,t===v&&(r=v,0===se&&ye(S));return t}())===v&&(t=function(){var t,r,n;se++,t=ae,t=(r=Ke())!==v?(n=je(),n!==v?function(){var t;h.substr(ae,8).toLowerCase()===qn?(t=h.substr(ae,8),ae+=8):(t=v,0===se&&ye(Jn));return t}()!==v?je()!==v?(n=ke())!==v?(ce=t,r=O(r,n)):(ae=t,v):(ae=t,v):(ae=t,v):(ae=t,v)):(ae=t,v);se--,t===v&&(r=v,0===se&&ye(F));return t}())===v&&(t=function(){var t,r,n;se++,t=ae,t=(r=Ke())!==v?(n=je(),n!==v?function(){var t;h.substr(ae,6).toLowerCase()===Qn?(t=h.substr(ae,6),ae+=6):(t=v,0===se&&ye(te));return t}()!==v?(ce=t,r=L(r)):(ae=t,v):(ae=t,v)):(ae=t,v);se--,t===v&&(r=v,0===se&&ye(M));return t}())===v&&(t=function(){var t,r,n;se++,t=ae,t=(r=Ke())!==v?(n=je(),n!==v?function(){var t;h.substr(ae,10).toLowerCase()===re?(t=h.substr(ae,10),ae+=10):(t=v,0===se&&ye(ne));return t}()!==v?(ce=t,r=H(r)):(ae=t,v):(ae=t,v)):(ae=t,v);se--,t===v&&(r=v,0===se&&ye(j));return t}())===v&&(t=function(){var t,r,n;se++,t=ae,t=(r=Ke())!==v?(n=je(),n!==v?function(){var t;h.substr(ae,5).toLowerCase()===ee?(t=h.substr(ae,5),ae+=5):(t=v,0===se&&ye(oe));return t}()!==v?je()!==v?(n=function(){var t;se++,t=ke(),se--,t===v&&(0===se&&ye(cn));return t}())!==v?(ce=t,r=N(r,n)):(ae=t,v):(ae=t,v):(ae=t,v):(ae=t,v)):(ae=t,v);se--,t===v&&(r=v,0===se&&ye(R));return t}());se--,t===v&&(r=v,0===se&&ye(m));return t}())===v)if(t=ae,qe()!==v){for(r=[],n=Ue();n!==v;)r.push(n),n=Ue();if(r!==v)if((n=Pe())!==v){for(e=[],o=Ue();o!==v;)e.push(o),o=Ue();t=e!==v&&(o=Je())!==v?(ce=t,y(n)):(ae=t,v)}else ae=t,t=v;else ae=t,t=v}else ae=t,t=v;return se--,t===v&&(0===se&&ye(a)),t}function _e(){var t,r,n,e;if(se++,t=ae,(r=ke())!==v){for(n=[],e=Ee();e!==v;)n.push(e),e=Ee();t=n!==v?(ce=t,r=E(r,n)):(ae=t,v)}else ae=t,t=v;return se--,t===v&&(r=v,0===se&&ye(o)),t}function Ee(){var t,r,n;return se++,t=ae,t=He()!==v?(44===h.charCodeAt(ae)?(r=b,ae++):(r=v,0===se&&ye(w)),r!==v&&He()!==v&&(n=ke())!==v?(ce=t,D(n)):(ae=t,v)):(ae=t,v),se--,t===v&&(0===se&&ye(e)),t}function be(){var t;return se++,(t=function(){var t,r,n,e,o,a,c,i,u,f,s,l;if(se++,t=ae,He()!==v)if(function(){var t;h.substr(ae,8).toLowerCase()===Zn?(t=h.substr(ae,8),ae+=8):(t=v,0===se&&ye(Bn));return t}()!==v)if(je()!==v)if((r=Ye())!==v)if(je()!==v)if(h.substr(ae,5).toLowerCase()===Q?(n=h.substr(ae,5),ae+=5):(n=v,0===se&&ye(tt)),n!==v)if(He()!==v)if(Ge()!==v)if(He()!==v)if((n=Ne())!==v){for(e=[],o=ae,a=je(),o=a!==v?(h.substr(ae,3).toLowerCase()===rt?(c=h.substr(ae,3),ae+=3):(c=v,0===se&&ye(nt)),c!==v?(i=He())!==v?(u=Ge())!==v?(f=He())!==v?(s=Ne())!==v?(l=He())!==v?a=[a,c,i,u,f,s,l]:(ae=o,v):(ae=o,v):(ae=o,v):(ae=o,v):(ae=o,v):(ae=o,v)):(ae=o,v);o!==v;)e.push(o),o=ae,a=je(),o=a!==v?(h.substr(ae,3).toLowerCase()===rt?(c=h.substr(ae,3),ae+=3):(c=v,0===se&&ye(nt)),c!==v?(i=He())!==v?(u=Ge())!==v?(f=He())!==v?(s=Ne())!==v?(l=He())!==v?a=[a,c,i,u,f,s,l]:(ae=o,v):(ae=o,v):(ae=o,v):(ae=o,v):(ae=o,v):(ae=o,v)):(ae=o,v);t=e!==v?(ce=t,et(r,n,e)):(ae=t,v)}else ae=t,t=v;else ae=t,t=v;else ae=t,t=v;else ae=t,t=v;else ae=t,t=v;else ae=t,t=v;else ae=t,t=v;else ae=t,t=v;else ae=t,t=v;else ae=t,t=v;se--,t===v&&(0===se&&ye(J));return t}())===v&&(t=function(){var t,r,n,e,o;if(se++,t=ae,He()!==v)if(function(){var t;h.substr(ae,4).toLowerCase()===Kn?(t=h.substr(ae,4),ae+=4):(t=v,0===se&&ye(kn));return t}()!==v)if(je()!==v)if((r=$e())===v&&(r=Xe()),r===v&&(r=null),r!==v)if((n=Ye())!==v){for(e=[],o=Re();o!==v;)e.push(o),o=Re();t=e!==v?(ce=t,$(r,n,e)):(ae=t,v)}else ae=t,t=v;else ae=t,t=v;else ae=t,t=v;else ae=t,t=v;else ae=t,t=v;se--,t===v&&(0===se&&ye(G));return t}())===v&&(t=function(){var t,r,n,e;if(se++,t=ae,He()!==v)if(function(){var t;h.substr(ae,6).toLowerCase()===jn?(t=h.substr(ae,6),ae+=6):(t=v,0===se&&ye(Hn));return t}()!==v)if(je()!==v)if((r=we())!==v){for(n=[],e=De();e!==v;)n.push(e),e=De();t=n!==v?(ce=t,K(r,n)):(ae=t,v)}else ae=t,t=v;else ae=t,t=v;else ae=t,t=v;else ae=t,t=v;se--,t===v&&(0===se&&ye(Y));return t}())===v&&(t=function(){var t,r;se++,t=ae,t=He()!==v?(r=function(){var t;h.substr(ae,4).toLowerCase()===Un?(t=h.substr(ae,4),ae+=4):(t=v,0===se&&ye(Yn));return t}(),r!==v?je()!==v?(r=We())!==v?(ce=t,V(r)):(ae=t,v):(ae=t,v):(ae=t,v)):(ae=t,v);se--,t===v&&(0===se&&ye(W));return t}()),se--,t===v&&(0===se&&ye(U)),t}function we(){var t,r,n,e,o;return se++,t=ae,(r=je())===v&&(r=null),t=r!==v?((n=$e())===v&&(n=Xe()),n===v&&(n=null),n!==v?((e=je())===v&&(e=null),e!==v&&(o=Ye())!==v?(ce=t,r=Z(n,o)):(ae=t,v)):(ae=t,v)):(ae=t,v),se--,t===v&&(r=v,0===se&&ye(k)),t}function De(){var t,r,n;return se++,t=ae,t=He()!==v?(44===h.charCodeAt(ae)?(r=b,ae++):(r=v,0===se&&ye(w)),r!==v&&He()!==v&&(n=we())!==v?(ce=t,z(n)):(ae=t,v)):(ae=t,v),se--,t===v&&(0===se&&ye(B)),t}function Re(){var t,r,n;return se++,t=ae,t=He()!==v?(44===h.charCodeAt(ae)?(r=b,ae++):(r=v,0===se&&ye(w)),r!==v&&He()!==v?((r=$e())===v&&(r=Xe()),r===v&&(r=null),r!==v&&(n=Ye())!==v?(ce=t,q(r,n)):(ae=t,v)):(ae=t,v)):(ae=t,v),se--,t===v&&(0===se&&ye(X)),t}function Ne(){var t,r,n,e;return se++,(t=Fe())===v&&(t=Se())===v&&(t=xe())===v&&(t=ae,34===h.charCodeAt(ae)?(r=at,ae++):(r=v,0===se&&ye(ct)),(t=r!==v?((n=Oe())===v&&(n=Me())===v&&(n=Se())===v&&(n=xe())===v&&(n=Fe()),n!==v?(34===h.charCodeAt(ae)?(e=at,ae++):(e=v,0===se&&ye(ct)),e!==v?(ce=t,r=it(n)):(ae=t,v)):(ae=t,v)):(ae=t,v))===v&&(t=ae,39===h.charCodeAt(ae)?(r=ut,ae++):(r=v,0===se&&ye(ft)),t=r!==v?((n=Oe())===v&&(n=Me())===v&&(n=Se())===v&&(n=xe())===v&&(n=Fe()),n!==v?(39===h.charCodeAt(ae)?(e=ut,ae++):(e=v,0===se&&ye(ft)),e!==v?(ce=t,r=it(n)):(ae=t,v)):(ae=t,v)):(ae=t,v))),se--,t===v&&(r=v,0===se&&ye(ot)),t}function Se(){var t,r,n,e;return se++,t=ae,h.substr(ae,4)===lt?(r=lt,ae+=4):(r=v,0===se&&ye(dt)),t=r!==v&&(n=We())!==v&&(e=function(){var t,r;se++,t=ae,121===h.charCodeAt(ae)?(r=mt,ae++):(r=v,0===se&&ye(Ct));r===v&&(77===h.charCodeAt(ae)?(r=Pt,ae++):(r=v,0===se&&ye(gt)),r===v&&(119===h.charCodeAt(ae)?(r=Tt,ae++):(r=v,0===se&&ye(_t)),r===v&&(100===h.charCodeAt(ae)?(r=Et,ae++):(r=v,0===se&&ye(bt)),r===v&&(104===h.charCodeAt(ae)?(r=wt,ae++):(r=v,0===se&&ye(Dt)),r===v&&(72===h.charCodeAt(ae)?(r=Rt,ae++):(r=v,0===se&&ye(Nt)),r===v&&(109===h.charCodeAt(ae)?(r=St,ae++):(r=v,0===se&&ye(xt)),r===v&&(115===h.charCodeAt(ae)?(r=Ft,ae++):(r=v,0===se&&ye(Ot)))))))));r!==v&&(ce=t,r=Mt());se--,(t=r)===v&&(r=v,0===se&&ye(yt));return t}())!==v?(ce=t,r=ht(n,e)):(ae=t,v),se--,t===v&&(r=v,0===se&&ye(st)),t}function xe(){var t,r;return se++,t=ae,h.substr(ae,3)===At?(r=At,ae+=3):(r=v,0===se&&ye(It)),r!==v&&(ce=t,r=pt()),se--,(t=r)===v&&(r=v,0===se&&ye(vt)),t}function Fe(){var t,r;return se++,t=ae,(r=We())!==v&&(ce=t,r=jt(r)),se--,(t=r)===v&&(r=v,0===se&&ye(Lt)),t}function Oe(){var t,r,n,e,o,a,c,i,u,f,s,l,d;return se++,t=ae,t=(r=Le())!==v?(45===h.charCodeAt(ae)?(n=Ut,ae++):(n=v,0===se&&ye(Yt)),n!==v&&(e=Le())!==v?(45===h.charCodeAt(ae)?(o=Ut,ae++):(o=v,0===se&&ye(Yt)),o!==v&&(a=Le())!==v?(84===h.charCodeAt(ae)?(c=Kt,ae++):(c=v,0===se&&ye(kt)),c!==v&&(i=Le())!==v?(58===h.charCodeAt(ae)?(u=Zt,ae++):(u=v,0===se&&ye(Bt)),u!==v&&(f=Le())!==v?(58===h.charCodeAt(ae)?(s=Zt,ae++):(s=v,0===se&&ye(Bt)),s!==v&&(l=Le())!==v&&(d=function(){var t,r,n,e;se++,t=ae,43===h.charCodeAt(ae)?(r=Qt,ae++):(r=v,0===se&&ye(tr));r===v&&(45===h.charCodeAt(ae)?(r=Ut,ae++):(r=v,0===se&&ye(Yt)));if(r!==v){if(n=[],$t.test(h.charAt(ae))?(e=h.charAt(ae),ae++):(e=v,0===se&&ye(Xt)),e!==v)for(;e!==v;)n.push(e),$t.test(h.charAt(ae))?(e=h.charAt(ae),ae++):(e=v,0===se&&ye(Xt));else n=v;t=n!==v?(h.substr(ae,2)===rr?(e=rr,ae+=2):(e=v,0===se&&ye(nr)),e===v&&(h.substr(ae,3)===er?(e=er,ae+=3):(e=v,0===se&&ye(or))),e===v&&(e=null),e!==v?(ce=t,r=ar(r,n,e)):(ae=t,v)):(ae=t,v)}else ae=t,t=v;se--,t===v&&(r=v,0===se&&ye(Jt));return t}())!==v?(ce=t,r=zt(r,e,a,i,f,l,d)):(ae=t,v)):(ae=t,v)):(ae=t,v)):(ae=t,v)):(ae=t,v)):(ae=t,v),se--,t===v&&(r=v,0===se&&ye(Ht)),t}function Me(){var t,r,n,e,o,a,c,i,u,f,s;return se++,t=ae,t=(r=Le())!==v?(45===h.charCodeAt(ae)?(n=Ut,ae++):(n=v,0===se&&ye(Yt)),n!==v&&(e=Le())!==v?(45===h.charCodeAt(ae)?(o=Ut,ae++):(o=v,0===se&&ye(Yt)),o!==v&&(a=Le())!==v&&je()!==v&&(c=Le())!==v?(58===h.charCodeAt(ae)?(i=Zt,ae++):(i=v,0===se&&ye(Bt)),i!==v&&(u=Le())!==v?(58===h.charCodeAt(ae)?(f=Zt,ae++):(f=v,0===se&&ye(Bt)),f!==v&&(s=Le())!==v?(ce=t,r=Vt(r,e,a,c,u,s)):(ae=t,v)):(ae=t,v)):(ae=t,v)):(ae=t,v)):(ae=t,v),se--,t===v&&(r=v,0===se&&ye(Wt)),t}function Le(){var t,r,n;if(se++,t=ae,r=[],$t.test(h.charAt(ae))?(n=h.charAt(ae),ae++):(n=v,0===se&&ye(Xt)),n!==v)for(;n!==v;)r.push(n),$t.test(h.charAt(ae))?(n=h.charAt(ae),ae++):(n=v,0===se&&ye(Xt));else r=v;return r!==v&&(ce=t,r=qt(r)),se--,(t=r)===v&&(r=v,0===se&&ye(Gt)),t}function je(){var t,r=[];if(cr.test(h.charAt(ae))?(t=h.charAt(ae),ae++):(t=v,0===se&&ye(ir)),t!==v)for(;t!==v;)r.push(t),cr.test(h.charAt(ae))?(t=h.charAt(ae),ae++):(t=v,0===se&&ye(ir));else r=v;return r}function He(){var t,r=[];for(cr.test(h.charAt(ae))?(t=h.charAt(ae),ae++):(t=v,0===se&&ye(ir));t!==v;)r.push(t),cr.test(h.charAt(ae))?(t=h.charAt(ae),ae++):(t=v,0===se&&ye(ir));return r}function Ue(){var t;return ur.test(h.charAt(ae))?(t=h.charAt(ae),ae++):(t=v,0===se&&ye(fr)),t}function Ye(){var t,r,n;if(se++,t=ae,r=[],vr.test(h.charAt(ae))?(n=h.charAt(ae),ae++):(n=v,0===se&&ye(Ar)),n!==v)for(;n!==v;)r.push(n),vr.test(h.charAt(ae))?(n=h.charAt(ae),ae++):(n=v,0===se&&ye(Ar));else r=v;return r!==v&&(ce=t,r=Ir(r)),se--,(t=r)===v&&(r=v,0===se&&ye(hr)),t}function Ke(){var t,r,n;if(se++,t=ae,r=[],vr.test(h.charAt(ae))?(n=h.charAt(ae),ae++):(n=v,0===se&&ye(Ar)),n!==v)for(;n!==v;)r.push(n),vr.test(h.charAt(ae))?(n=h.charAt(ae),ae++):(n=v,0===se&&ye(Ar));else r=v;return t=r!==v?((n=function(){var t,r,n,e,o;se++,t=ae,60===h.charCodeAt(ae)?(r=Cr,ae++):(r=v,0===se&&ye(Pr));if(r!==v){if(n=[],gr.test(h.charAt(ae))?(e=h.charAt(ae),ae++):(e=v,0===se&&ye(Tr)),e!==v)for(;e!==v;)n.push(e),gr.test(h.charAt(ae))?(e=h.charAt(ae),ae++):(e=v,0===se&&ye(Tr));else n=v;t=n!==v?((e=function(){var t,r,n,e;se++,t=ae,60===h.charCodeAt(ae)?(r=Cr,ae++):(r=v,0===se&&ye(Pr));if(r!==v){if(n=[],Dr.test(h.charAt(ae))?(e=h.charAt(ae),ae++):(e=v,0===se&&ye(Rr)),e!==v)for(;e!==v;)n.push(e),Dr.test(h.charAt(ae))?(e=h.charAt(ae),ae++):(e=v,0===se&&ye(Rr));else n=v;t=n!==v?(62===h.charCodeAt(ae)?(e=_r,ae++):(e=v,0===se&&ye(Er)),e!==v?(ce=t,r=Nr(n)):(ae=t,v)):(ae=t,v)}else ae=t,t=v;se--,t===v&&(r=v,0===se&&ye(wr));return t}())===v&&(e=null),e!==v?(62===h.charCodeAt(ae)?(o=_r,ae++):(o=v,0===se&&ye(Er)),o!==v?(ce=t,r=br(n,e)):(ae=t,v)):(ae=t,v)):(ae=t,v)}else ae=t,t=v;se--,t===v&&(r=v,0===se&&ye(mr));return t}())===v&&(n=null),n!==v?(ce=t,r=yr(r,n)):(ae=t,v)):(ae=t,v),se--,t===v&&(r=v,0===se&&ye(pr)),t}function ke(){var t,r,n,e;if(se++,(t=function(){var t,r,n,e;if(se++,r=t=ae,n=[],xr.test(h.charAt(ae))?(e=h.charAt(ae),ae++):(e=v,0===se&&ye(Fr)),e!==v)for(;e!==v;)n.push(e),xr.test(h.charAt(ae))?(e=h.charAt(ae),ae++):(e=v,0===se&&ye(Fr));else n=v;return(r=n!==v?h.substring(r,ae):n)!==v&&(ce=t,r=Or(r)),se--,(t=r)===v&&(r=v,0===se&&ye(Sr)),t}())===v){if(t=ae,34===h.charCodeAt(ae)?(r=at,ae++):(r=v,0===se&&ye(ct)),r!==v){for(n=[],e=Ze();e!==v;)n.push(e),e=Ze();t=n!==v?(34===h.charCodeAt(ae)?(e=at,ae++):(e=v,0===se&&ye(ct)),e!==v?(ce=t,r=Lr(n)):(ae=t,v)):(ae=t,v)}else ae=t,t=v;if(t===v)if(t=ae,39===h.charCodeAt(ae)?(r=ut,ae++):(r=v,0===se&&ye(ft)),r!==v){for(n=[],e=Be();e!==v;)n.push(e),e=Be();t=n!==v?(39===h.charCodeAt(ae)?(e=ut,ae++):(e=v,0===se&&ye(ft)),e!==v?(ce=t,r=Lr(n)):(ae=t,v)):(ae=t,v)}else ae=t,t=v}return se--,t===v&&(r=v,0===se&&ye(Mr)),t}function Ze(){var t,r=ae,n=ae;return se++,34===h.charCodeAt(ae)?(t=at,ae++):(t=v,0===se&&ye(ct)),t===v&&(92===h.charCodeAt(ae)?(t=jr,ae++):(t=v,0===se&&ye(Hr))),se--,(r=(n=t===v?void 0:(ae=n,v))!==v?(h.length>ae?(t=h.charAt(ae),ae++):(t=v,0===se&&ye(Ur)),t!==v?(ce=r,n=Yr(t)):(ae=r,v)):(ae=r,v))===v&&(r=ae,92===h.charCodeAt(ae)?(n=jr,ae++):(n=v,0===se&&ye(Hr)),r=n!==v&&(t=ze())!==v?(ce=r,n=Kr(t)):(ae=r,v)),r}function Be(){var t,r=ae,n=ae;return se++,39===h.charCodeAt(ae)?(t=ut,ae++):(t=v,0===se&&ye(ft)),t===v&&(92===h.charCodeAt(ae)?(t=jr,ae++):(t=v,0===se&&ye(Hr))),se--,(r=(n=t===v?void 0:(ae=n,v))!==v?(h.length>ae?(t=h.charAt(ae),ae++):(t=v,0===se&&ye(Ur)),t!==v?(ce=r,n=Yr(t)):(ae=r,v)):(ae=r,v))===v&&(r=ae,92===h.charCodeAt(ae)?(n=jr,ae++):(n=v,0===se&&ye(Hr)),r=n!==v&&(t=ze())!==v?(ce=r,n=Kr(t)):(ae=r,v)),r}function ze(){var t,r;return 39===h.charCodeAt(ae)?(t=ut,ae++):(t=v,0===se&&ye(ft)),t===v&&(34===h.charCodeAt(ae)?(t=at,ae++):(t=v,0===se&&ye(ct)),t===v&&(92===h.charCodeAt(ae)?(t=jr,ae++):(t=v,0===se&&ye(Hr)),t===v&&(t=ae,98===h.charCodeAt(ae)?(r=kr,ae++):(r=v,0===se&&ye(Zr)),r!==v&&(ce=t,r=Br()),(t=r)===v&&(t=ae,102===h.charCodeAt(ae)?(r=zr,ae++):(r=v,0===se&&ye(Wr)),r!==v&&(ce=t,r=Vr()),(t=r)===v&&(t=ae,110===h.charCodeAt(ae)?(r=Gr,ae++):(r=v,0===se&&ye($r)),r!==v&&(ce=t,r=Xr()),(t=r)===v&&(t=ae,114===h.charCodeAt(ae)?(r=qr,ae++):(r=v,0===se&&ye(Jr)),r!==v&&(ce=t,r=Qr()),(t=r)===v&&(t=ae,116===h.charCodeAt(ae)?(r=tn,ae++):(r=v,0===se&&ye(rn)),r!==v&&(ce=t,r=nn()),(t=r)===v&&(t=ae,118===h.charCodeAt(ae)?(r=en,ae++):(r=v,0===se&&ye(on)),r!==v&&(ce=t,r=an()),t=r)))))))),t}function We(){var t,r=ae,n=[];if($t.test(h.charAt(ae))?(t=h.charAt(ae),ae++):(t=v,0===se&&ye(Xt)),t!==v)for(;t!==v;)n.push(t),$t.test(h.charAt(ae))?(t=h.charAt(ae),ae++):(t=v,0===se&&ye(Xt));else n=v;return n!==v&&(ce=r,n=un(n)),r=n}function Ve(){var t;return 124===h.charCodeAt(ae)?(t=mn,ae++):(t=v,0===se&&ye(Cn)),t}function Ge(){var t;return 61===h.charCodeAt(ae)?(t=Pn,ae++):(t=v,0===se&&ye(gn)),t}function $e(){var t;return 43===h.charCodeAt(ae)?(t=Qt,ae++):(t=v,0===se&&ye(tr)),t}function Xe(){var t;return 45===h.charCodeAt(ae)?(t=Ut,ae++):(t=v,0===se&&ye(Yt)),t}function qe(){var t;return 40===h.charCodeAt(ae)?(t=Rn,ae++):(t=v,0===se&&ye(Nn)),t}function Je(){var t;return 41===h.charCodeAt(ae)?(t=Sn,ae++):(t=v,0===se&&ye(xn)),t}var Qe="AND",to="OR",ro="+",no=":param_",eo=["IP","IPv4","IPv6","Array","Array<IPv4>","Array<CIDR_IPv4>","Array<IPv6>","Array<CIDR_IPv6>","Map"],oo=72e5,ao=/^(25[0-5]|2[0-4]\d|[0-1]\d{2}|[1-9]?\d)\.(25[0-5]|2[0-4]\d|[0-1]\d{2}|[1-9]?\d)\.(25[0-5]|2[0-4]\d|[0-1]\d{2}|[1-9]?\d)\.(25[0-5]|2[0-4]\d|[0-1]\d{2}|[1-9]?\d)$/,co=/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/,io=[],uo={},fo={},so=(new Date).getTime();function lo(t,r){if(!t||-1===t.indexOf("/"))return!1;var n=t.split("/");if(2!==n.length)return!1;t=_slicedToArray(n,2),n=t[0],t=t[1];if(!n||isNaN(+t))return!1;t=+t;return"IPv4"===r?!!(ao.test(n)&&0<t&&t<=32):"IPv6"===r&&!!(co.test(n)&&0<t&&t<=128)}function ho(t){return+t<10?"0".concat(t):t}function vo(t){var r=new Date(void 0===t?new Date:t),n=r.getUTCFullYear(),e=r.getUTCMonth()+1,o=r.getUTCDate(),a=r.getUTCHours(),t=r.getUTCMinutes(),r=r.getUTCSeconds();return n+"-"+ho(e)+"-"+ho(o)+" "+ho(a)+":"+ho(t)+":"+ho(r)}function Ao(t,r){var n=de(),e=n.start,n=n.end,e=no+e.line+"_"+e.offset+"_"+n.line+"_"+n.offset,n=e;return"IPv4"===r&&(n="toIPv4(".concat(e,")")),"IPv6"===r&&(n="toIPv6(".concat(e,")")),"Array"===r&&(n="has(".concat(t,", ").concat(e,")=1")),"Array<IPv4>"===r&&(n="has(".concat(t,", toIPv4(").concat(e,"))=1")),"Array<IPv6>"===r&&(n="has(".concat(t,", toIPv6(").concat(e,"))=1")),{paramKey:e,paramName:n}}function Io(t,r){fo.hasOwnProperty(t)||(fo[t.replace(":","")]=r)}function po(t,r,n,e){var o="".concat(t,"_").concat(r||"","_").concat(n,"_").concat(e);uo[o]||(uo[o]={field:t,fieldType:r,operator:n,operand:e})}var yo=void 0!==(r=t.json)&&r,mo=void 0===(r=t.hasAgingTime)||r,Co=void 0===(r=t.timePrecision)?9:r,Po=void 0===(r=t.includeStartTime)||r,go=void 0===(t=t.includeEndTime)||t;if((n=n())!==v&&ae===h.length)return n;throw n!==v&&ae<h.length&&ye({type:"end"}),me(fe,ue<h.length?h.charAt(ue):null,ue<h.length?pe(ue,ue+1):pe(ue,ue))}}});