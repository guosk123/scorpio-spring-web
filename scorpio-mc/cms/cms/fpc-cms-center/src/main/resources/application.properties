# override application-common.properties
machloop.application.component=001003

server.port=41120
server.servlet.context-path=/center
server.servlet.session.timeout=86400
server.ssl.enabled-protocols=TLSv1.2,TLSv1.3
server.ssl.key-store-password=ENC(UmOTFjB0MwzC0ddUbgfpMzZDBe1/YoEv)
server.ssl.key-store=/opt/components/fpc-apps/resource/machloop.jks

#
fpc.cms.server.ip=127.0.0.1
management.server.port=41129

#
fpc.cms.grpc.port=41121
download.server.protocol=https
download.server.port=443

spring.servlet.multipart.max-file-size=1024MB
spring.servlet.multipart.max-request-size=1024MB

# template & static
spring.thymeleaf.prefix=file:/opt/components/fpc-apps/fpc-cms-center-web/template/
spring.thymeleaf.cache=false
spring.resources.static-locations=file:${FPC_CONFIG}/fpc-apps/resource/,file:/opt/components/fpc-apps/fpc-cms-center-web/static/

#
product.name=MachLake-CMS
product.series=1000
product.os=
product.cpu-model=
product.version=1.0.0
product.description=\u5bf9\u591a\u53f0\u0046\u0050\u0043\u8bbe\u5907\u63d0\u4f9b\u96c6\u4e2d\u7ba1\u7406\u529f\u80fd
product.corporation=\u5317\u4eac\u9a6c\u8d6b\u8c37\u79d1\u6280\u6709\u9650\u516c\u53f8
product.license-form=\u4F7F\u7528\u7248\u6388\u6743
product.license-deadline=2019-12-31

#
loggeduser.forbidden.max.failed=5
loggeduser.forbidden.duration.second=1800
loggeduser.concurrent.max.session=1
loggeduser.concurrent.prevent=false
loggeduser.session.expired.second=600

#
webapp.master.server=127.0.0.1

#
fpc.cms.node.id=
fpc.cms.grpc.token=ENC(5NGVfSigLNLx1/1er7Le2II9pty2rcqY0fXZQFbkSrZHDOPzZMzgdR4qrf/vNUFF)
fpc.cms.max.series=3

# clickhouse
clickhouse.url=jdbc:clickhouse://localhost:8123/fpc?socket_timeout=600000&connection_timeout=600000
clickhouse.username=clickhouse
clickhouse.password=ENC(D2npjk66cS0nOfvUlf0qf2Cfxp5M+uGs)
clickhouse.driver-class-name=com.clickhouse.jdbc.ClickHouseDriver
clickhouse.connection.timeout.ms=600000
clickhouse.connection.MaximumPoolSize=20
# clickhouse remote server
clickhouse.tcp.ssl.port=9440
ch_stats.tcp.ssl.port=9441
clickhouse.remote.server.username=clickhouse
clickhouse.remote.server.password=ENC(D2npjk66cS0nOfvUlf0qf2Cfxp5M+uGs)

# rocketmq
rocketmq.namesrv.host=127.0.0.1
rocketmq.namesrv.port=9876

rocketmq.broker.name=cms_broker
# fileReservedTime Unit:h
rocketmq.broker.file-reserved-time=72

rocketmq.admin.connection.timeout.ms=10000

rocketmq.producer.group-name=cms_producer
# maxMessageSize Unit:MB
rocketmq.producer.max.message.size=10
rocketmq.producer.send.timeout.ms=10000

rocketmq.consumer.group-name=cms_consumer
rocketmq.consumer.consume-message-batch-size=1

# fpc engine rest
fpc.engine.rest.server.port=443
fpc.engine.rest.server.protocol=https

#
file.ntp.log.path=${FPC_LOG}/${FPC_APP}/ntp-log.txt
device.ntpd.enable=true
device.ntp.conf.path=/etc/ntp.conf

#
fpc.manager.server.port=443
fpc.manager.server.protocol=https
cms.center.server.port=443
cms.center.server.protocol=https

#
fpc.manager.download.task.rest.address={fpcIp}:{fpcPort}/manager/restapi/fpc-v1/appliance/transmition-tasks/{fpcTaskId}/files
fpc.manager.import.license.rest.address={fpcIp}:{fpcPort}/manager/restapi/fpc-v1/appliance/licenses
fpc.manager.solve.alert.address={fpcIp}:{fpcPort}/manager/restapi/fpc-v1/appliance/alert-messages/{id}/solve?reason={reason}
fpc.manager.webshark.rest.address={fpcIp}:{fpcPort}/manager/restapi/fpc-v1/webshark/analysis?queryId={queryId}&filePath={filePath}&type={type}&parameter={parameter}
fpc.manager.suricata.rest.address={fpcIp}:{fpcPort}/manager/restapi/fpc-v1/appliance/suricata-rules/as-import/issued
fpc.cms.suricata.rest.address={cmsIp}:{cmsPort}/center/restapi/fpc-cms-v1/appliance/suricata-rules/as-import/issued
fpc.manager.domain.rest.address={fpcIp}:{fpcPort}/manager/restapi/fpc-v1/appliance/domain-white
fpc.cms.domain.rest.address={cmsIp}:{cmsPort}/center/restapi/fpc-cms-v1/appliance/domain-white
sso.login.api={deviceIp}:{devicePort}/{servletContext}/webapi/v1/sso/login?jwt={jwt}

#
filesys.mount.root.system=/

# export
export.protocol.log.max.count=100000
export.suricata.alert.max.count=100000
export.flow.log.max.count=100000
export.suricata.alert.batch.size=1000
export.flow.log.batch.size=1000

# rest query count
rest.metric.result.query.max.count=10000
rest.flowlog.result.query.max.count=1000
rest.metadata.result.query.max.count=1000

#
global.death.query.expire.ms=10000

# bi
bi.entry=/@bi/web-static/
bi.jwt.secret=ENC(vkwmj1JnGuAgYP1zl9zKxWBdN+b+BaFWn/CyZHGKczQ=)

#
file.megacli64.path=/opt/MegaRAID/MegaCli/MegaCli64
file.archive.log.path=/home/fpc-cms/archive/logs
file.archive.alarm.path=/home/fpc-cms/archive/alarms
file.system.backup.path=/home/fpc-cms/backup
file.system.backup.pgdump.path=/usr/pgsql-11/bin/pg_dump
file.runtime.path=/opt/machloop/run
file.iptools.path=/opt/machloop/scripts/iptools
file.snmptools.path=/opt/machloop/scripts/snmptools
file.clickhouse.config.path=/opt/machloop/config/clickhouse/config.xml
file.sa.knowledge.path=${FPC_CONFIG}/fpc-knowledge/sa_rule_enc.txt
file.geoip.knowledge.path=${FPC_CONFIG}/fpc-knowledge/geoip_rule_enc.txt
file.license.path=${FPC_CONFIG}/fpc-apps/license.signed.txt
file.hostGroup.template.path=/opt/components/fpc-apps/resource/hostGroup-import-temp.csv
file.DomainWhiteList.template.path=/opt/components/fpc-apps/resource/domainWhiteList-import-temp.csv
file.filterRule.template.path=/opt/components/fpc-apps/resource/filterRule-import-temp.csv
file.suricata.rule.template.path=/opt/components/fpc-apps/resource/suricata-rule-import-temp.csv
file.suricata.classtype.template.path=/opt/components/fpc-apps/resource/suricata-classtype-import-temp.csv
file.sa.custom.template.path=/opt/components/fpc-apps/resource/sa-custom-import-temp.csv
file.geoip.custom.country.template.path=/opt/components/fpc-apps/resource/geoip-country-import-temp.csv
file.service.template.path=/opt/components/fpc-apps/resource/service-import-temp.csv
file.abnormal.event.template.path=/opt/components/fpc-apps/resource/abnormal-event-import-temp.csv
#
file.js.spl2sql.path=/opt/components/fpc-apps/resource/spl2sql.js
file.js.spl2dsl.path=/opt/components/fpc-apps/resource/spl2dsl.js
file.js.regex.path=/opt/components/fpc-apps/resource/regex.js

#
task.system.backup.schedule.cron=0 0 2 * * ?
task.system.archive.schedule.cron=0 0 3 * * ?
task.system.send.syslog.schedule.cron=0/5 * * * * ?
task.heartbeat.schedule.fixedrate.ms=3000
task.sendup.schedule.fixedrate.ms=1000
task.resend.schedule.cron=0 0/5 * * * ?
task.sync.configuration.schedule.cron=0 0/10 * * * ?
task.assignment.execute.schedule.fixedrate.ms=5000
task.assignment.expire.schedule.fixedrate.ms=30000
task.query.cancel.schedule.fixedrate.ms=5000
task.clear.log.alarm.cron=0 0 0/1 * * ?
task.clear.collect.metric.cron=0 0 0/1 * * ?
task.clear.metric-in-second.cron=0 30 8 * * ?
task.system.send.mail.schedule.cron=0/5 * * * * ?
# baseline
baseline.result.retention.hour=1
task.setting.sync.schedule.fixedrate.ms=3000
task.mission.hour.cron=0 0 0/1 * * ? 
task.mission.minute.cron=0 0/1 * * * ?
task.mission.five.minute.cron=0 0/5 * * * ?
task.mission.retry.schedule.fixedrate.ms=10000
task.mission.retry.max=2 
task.publish.clean.cron=0 0 0/1 * * ?

# backup for springboot-ssl
#server.ssl.enabled=false
#server.ssl.key-store=classpath:machloop.keystore
#server.ssl.key-store-password=123456
#server.ssl.key-password=654321
#server.ssl.client-auth=need
#server.ssl.trust-store=classpath:machloop.keystore
#server.ssl.trust-store-password=123456

# upgrade
file.upgrade.software.path=/opt/fpc-update/tars
file.upgrade.script.path=/opt/fpc-update/tars/tfa/update.sh
file.upgrade.version.path=${FPC_CONFIG}/update_status
file.upgrade.log.path=${FPC_LOG}/fpc-update.log